\documentclass{article}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage[english]{babel}
\usepackage{math}
\usepackage{unicode}
\usepackage[margin=15mm]{geometry}

\let\fr\mathfrak

\begin{document}
\title{Conjugacy classes of square $ℓ$-adic matrices of size~$2$}

\section{General remarks}

Let~$ℓ$ be a prime number and~$f(x) = x^2 + px + q$ be a unitary
polynomial with coefficients in~$ℤ_{ℓ}$.

\begin{prop}
The conjugacy classes of matrices in~$ℤ_{ℓ}^{2×2}$ with characteristic
polynomial~$f$ correspond bijectively to ideal classes of the order~$R =
ℤ_{ℓ}[α] / f(α)$.
\end{prop}

\begin{proof}
The proof for~$ℤ$ also applies to~$ℤ_2$.
\end{proof}

XXX: quasi-descente de la décomposition en sous-espaces caractéristiques.

\section{The case~$ℓ = 2$}


\subsection{Multiplicative structure of quadratic extensions of~$ℚ_2$}

\begin{prop}
There exists group isomorphisms
\begin{align*}
ℤ_2^{×} &≃ (-1)^{ℤ/2ℤ} × (-3)^{ℤ_2};\\
(ℤ_2/2^m ℤ_2)^{×} &≃ \begin{cases} 1, & m = 1;\\
(-1)^{ℤ/2ℤ} × (-3)^{ℤ/2^{m-2}ℤ},& m ≥ 2.\\\end{cases}
\end{align*}
\end{prop}

We deduce from this proposition that the set of squares in~$ℤ_2$ is
exactly~$4^{ℤ} (1 + 8 ℤ_2)$, and that $ℚ_2^{×}$~modulo the squares has
the eight classes~$±1, ±2, ±3, ±6$.

Write~$ℤ_4 = ℤ_2[ω]/(ω^2-ω+1)$. We then have~$(1-2ω)^2 = -3$, which is
therefore a square in~$ℤ_4$ (but not in~$ℤ_2$).

\begin{prop}
There exists group isomorphisms
\begin{align*}
ℤ_4^{×} &≃ ω^{ℤ/6ℤ} × (1 - 2 ω)^{ℤ_2} × (1 + 4 ω)^{ℤ_2};\\
(ℤ_4/2^m ℤ_4)^{×} &≃ \begin{cases} ω^{ℤ/3ℤ},& m = 1;\\
ω^{ℤ/6ℤ} × (1-2ω)^{ℤ/2^{m-1}ℤ} × (1+4ω)^{ℤ/2^{m-2}ℤ}, & m ≥ 2.\\ \end{cases}
\end{align*}
\end{prop}
In this decomposition, the subgroup~$ℤ_2^{×}$ manifests itself
as~$ω^{3ℤ/6ℤ} × (1-2ω)^{2 ℤ_2}$.


\begin{prop}
Let~$A_n = ℤ_2[2^n ω]$ be the order of~$ℚ_4$ with conductor~$2^n ℤ_4$.
Then
\begin{align*}
A_1^{×} &≃ (-1)^{ℤ/2ℤ} × (1-2ω)^{ℤ_2} × (1 + 4 ω)^{ℤ_2};\\
A_n^{×} &≃ (-1)^{ℤ/2ℤ} × (-3)^{ℤ_2} × (1+4ω)^{2^n ℤ_2},\quad n ≥ 2.
\end{align*}
\end{prop}


The ramified extension~$ℚ_2[√{-1}]$ has the uniformiser~$π = √{-1}-1$ and
the integer ring~$ℤ_2[π]$. 
\begin{prop}
There exists group isomorphisms
\begin{align*}
ℤ_2[√{-1}]^{×} &≃ (√{-1})^{ℤ/4ℤ} × (-3)^{ℤ_2} × (1+2π)^{ℤ_2};\\
(ℤ_2[√{-1}]/π^m ℤ_2[√{-1}])^{×} &≃\begin{cases}
(1+π)^{ℤ/2^{m-1}ℤ},&m ≤ 2;\\
(1+π)^{ℤ/4ℤ} ×(-3)^{ℤ/2^{r-1} ℤ} ×(1+2π)^{ℤ/2^{r-1}ℤ},&m=2r+1,r ≥ 1;\\
(1+π)^{ℤ/4ℤ} ×(-3)^{ℤ/2^{r-1} ℤ} ×(1+2π)^{ℤ/2^{r}ℤ},&m=2r+2,r ≥ 1.\\
\end{cases}\end{align*}
% In this decomposition, the subgroup~$ℤ_2^{×}$ manifests itself
% as $(√{-1})^{2ℤ/4ℤ} × (-3)^{ℤ_2}$.
\end{prop}

The ramified extension~$ℚ_2[√{3}]$ has the uniformiser~$π = √{3}-1$ and
the integer ring~$ℤ_2[π]$.
\begin{prop}
There exists group isomorphisms
\begin{align*}
ℤ_2[√{3}]^{×} &≃ (-1)^{ℤ/2ℤ} × (1+π)^{ℤ_2} × (1+2π)^{ℤ_2};\\
(ℤ_2[√{3}]/π^m ℤ_2[√{3}])^{×} &≃\begin{cases}
(1+π)^{ℤ/2ℤ},&m = 2;\\
(1+π)^{ℤ/4ℤ},&m = 3;\\
(1+π)^{ℤ/4ℤ} × (1+2π)^{ℤ/2ℤ},&m = 4;\\
(-1)^{ℤ/2ℤ} × (1+π)^{ℤ/2^rℤ} × (1+2π)^{ℤ/2^{r-1} ℤ},&m = 2r+1, r ≥ 2;\\
(-1)^{ℤ/2ℤ} × (1+π)^{ℤ/2^r ℤ} × (1+2π)^{ℤ/2^r ℤ},&m = 2r+2, r ≥ 2.
\end{cases}
\end{align*}
\end{prop}

Note that in $(ℤ_2[√{3}]/π^4)^{×}$ there is the relation $-1 ≡ (1+π)^2
\pmod{π^4}$; therefore, we have
\begin{equation}
v_{π} ((1+π)^{2^n} - 1) = \begin{cases}n+1,& n ≤ 1;\\2n+2,&n ≥ 2. \end{cases}
\end{equation}


The ramified extension~$ℚ[√2]$ has the uniformiser~$π = √{2}$. The group
$1+2π ℤ_2[π]$ is topologically generated by~$(-1)·(1+π)^2 = 1 + 2π + 4$.
% For each~$n$, we have~$v_{π} ((1+π)^{2^n}-1) = n+1$ if~$n ≤ 1$
% and~$2n+1$ if~$n ≥ 2$.
\begin{prop}
There exists group isomorphisms
\begin{align*}
ℤ_2[π]^{×} &≃ (-1)^{ℤ/2ℤ} × (-3)^{ℤ_2} × (1+π)^{ℤ_2},\\
(ℤ_2[π]/π^m)^{×} &≃ \begin{cases}(1+π)^{ℤ/2^{m-1}ℤ},&m ≤ 2;\\
(-1)^{ℤ/2ℤ} × (-3)^{ℤ/2^{r-2}ℤ} × (1+π)^{ℤ/2^{r}ℤ},&m=2r, r≥2;\\
(-1)^{ℤ/2ℤ} × (-3)^{ℤ/2^{r-1}ℤ} × (1+π)^{ℤ/2^{r}ℤ},&m=2r+1, r≥2.
\end{cases}\end{align*}
\end{prop}

% \begin{lem}
% Let~$D ∈ ℤ_2$ and write
% \[ ρ(D) = \max \acco { v_{2} (x^2 - D), x ∈ ℤ_2 }. \]
% Then
% \begin{enumerate}
% \item if $D ≡ 0 \pmod{4}$, then $ρ(D) = ρ(D/4) + 1$;
% \item if $D ≡ 2 \pmod{4}$, then $ρ(D) = 1$;
% \item if $D ≡ 3 \pmod{4}$, then $ρ(D) = 1$;
% \item if $D ≡ 5 \pmod{8}$, then $ρ(D) = 2$;
% \item if $D ≡ 1 \pmod{8}$, then $D$~is a square in~$ℤ_2$ (in other words,
% $ρ(D) = +∞$).
% \end{enumerate}
% \end{lem}

\subsection{Conjugacy classes of matrices}

Let~$f(x) = x^2+px+q$ be an irreducible quadratic polynomial with coefficients
in~$ℤ_2$. Let~$D = p^2 - 4q = 4^m D'$ be the discriminant of~$D$,
with~$v_2(D') ≤ 1$. Let~$R = ℤ_2[α]/f(α)$; we have~$2α = -p + 2^m √{D'}$
and the fraction field of~$R$ is~$ℚ_2[√{D'}]$.

Let~$H(R)$ be the class group of~$R$. By Section~1, $H(R)$~is in
bijection with the set of all conjugacy classes of matrices
in~$ℤ_2^{2×2}$ with characteristic polynomial equal to~$f$.

If $D'$~is odd, then $ℚ_2[√{D'}]$~is unramified and therefore isomorphic
to~$ℚ_4$, and $R$~is the order of~$ℚ_4$ with $ℤ_2$-basis~$\acco{1,
α}$. In this case, since the maximal order~$ℤ_4$ of~$ℚ_4$ is principal,
the class group~$H(R)$ is isomorphic to
\begin{equation}
( ℤ_4/\fr c)^{×} \,/\, (ℤ[α]/\fr c)^{×},
\end{equation}
where $\fr c$~is the conductor ideal of~$R$ in~$ℤ_4$.

\paragraph{If $p$~is odd.} Since $f$~is irreducible, its Newton polygon
has only one slope, and therefore $q$~is also odd. This implies that~$D ≡
5 \pmod{8}$; therefore, $ℤ_4 = ℤ_2[θ]$ with~$θ = \frac{1+√{D}}{2}$. We
may therefore write
\begin{equation}
θ = α + \frac{p+1}{2},
\end{equation}
which implies that~$ℤ[α] = ℤ_4$. Therefore, $H(R) = H(ℤ_4) = 1$.


\medskip

In all other cases, note that since $p$~is even, $D = p^2-4q$~is
divisible by~$4$. Write~$D = 4^n u^2 d$ with~$n ≥ 1$, $u ∈ ℤ_2^{×}$,
and~$d ∈ \acco { -1, ±2, ±3, ±6 }$ (the case~$d = 1$ corresponds to
$f$~split). In all cases, we have~$ℚ_2(α) = ℚ_2(√d)$.

\paragraph{If $d = -3$.} In this case, $ℚ_2(√d) = ℚ_4$. Its
maximal order is generated by~$ω = \frac{1+√{-3}}{2}$, and we may
write~$2^n u ω = α + p/2 + 2^{n-1}u$. Therefore, the conductor of~$ℤ[α]$
is~$\fr c = 2^{n} ℤ_4 = (2^n, α+p/2+2^{n-1} u)$, and we have
\begin{equation}
ℤ_2[α]/\fr c ≃ ℤ/2^n ℤ, \quad
(ℤ_2[α]/\fr c)^{×} ≃ \begin{cases} 1, & n = 1;\\
(-1)^{ℤ/2ℤ} × (-3)^{ℤ/2^{n-2}ℤ},& n ≥ 2.\\\end{cases}
\end{equation}
From this we deduce
\begin{equation}
H(ℤ_2[α]) ≃ 
\begin{cases} ℤ/3ℤ,& n = 1;\\ (ℤ/6ℤ) × (ℤ/2^{n-2}ℤ), & n ≥ 2. \end{cases}
\end{equation}

\paragraph{If $d = -1$.} In this case, $π = √{-1}-1$ is a uniformiser
of~$ℚ(√{d})$, and we may write~$2^{n-1} u π = α + p/2 - 2^{n-1} u$.
Therefore, the conductor of~$ℤ[α]$ is~$\fr c = 2^{n-1}
ℤ_2[π] = (2^{n-1}, α+p/2-2^{n-1} u)$, and we have
\begin{equation}
ℤ_2[α]/\fr c ≃ ℤ/2^{n-1} ℤ, \quad
(ℤ_2[α]/\fr c)^{×} ≃ \begin{cases} 1,&n ≤ 2;\\
(-1)^{ℤ/2ℤ} × (-3)^{ℤ/2^{n-3} ℤ},&n ≥ 3.\end{cases}
\end{equation}
From this we deduce
\begin{equation}
H(ℤ_2[α]) ≃ \begin{cases} 0, & n = 1;\\
ℤ/2ℤ, & n = 2;\\ (ℤ/4ℤ) × (ℤ/2^{n-2}ℤ), & n ≥ 3. \end{cases}
\end{equation}

\paragraph{If $d = 3$.} In this case, $π = √{3}-1$ is a uniformiser
of~$ℚ(√{d})$, and we may write~$2^{n-1} u π = α + p/2 - 2^{n-1} u$. As in
the previous case, we have
\begin{equation}
ℤ_2[α]/\fr c ≃ ℤ/2^{n-1} ℤ, \quad
(ℤ_2[α]/\fr c)^{×} ≃ \begin{cases} 1,&n ≤ 2;\\
(-1)^{ℤ/2ℤ} × (-3)^{ℤ/2^{n-3} ℤ},&n ≥ 3.\end{cases}
\end{equation}
From this we deduce
\begin{equation}
H(ℤ_2[α]) ≃ \begin{cases} 0, & n = 1;\\
(ℤ/2ℤ) × (ℤ/2^{n-2}ℤ),& n ≥ 2.\\\end{cases}
% n = 3: générateurs = 3 et 1+2π
% n ≥ 4: générateurs = -3 et 1+2π
\end{equation}
\end{document}
