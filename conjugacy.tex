\documentclass{article}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage[english]{babel}
\usepackage{math}
\usepackage{unicode}
\usepackage[margin=15mm]{geometry}

\let\fr\mathfrak
\DeclareMathOperator\Cl{Cl}
\def\smat{\small\mat}

\begin{document}
\title{Conjugacy classes of square $ℓ$-adic matrices of size~$2$}

\section{General remarks}

Let~$ℓ$ be a prime number and~$f(x) = x^2 + px + q$ be a unitary
polynomial with coefficients in~$ℤ_{ℓ}$.

\begin{prop}
The conjugacy classes of matrices in~$ℤ_{ℓ}^{2×2}$ with characteristic
polynomial~$f$ correspond bijectively to ideal classes of the order~$R =
ℤ_{ℓ}[α] / f(α)$.
\end{prop}

\begin{proof}
The proof for~$ℤ$ also applies to~$ℤ_2$.
\end{proof}

XXX: quasi-descente de la décomposition en sous-espaces caractéristiques.

\section{The case~$ℓ = 2$}


\subsection{Multiplicative structure of quadratic extensions of~$ℚ_2$}

\begin{prop}
There exists group isomorphisms
\begin{align*}
ℤ_2^{×} &≃ (-1)^{ℤ/2ℤ} × (-3)^{ℤ_2};\\
(ℤ_2/2^m ℤ_2)^{×} &≃ \begin{cases} 1, & m = 1;\\
(-1)^{ℤ/2ℤ} × (-3)^{ℤ/2^{m-2}ℤ},& m ≥ 2.\\\end{cases}
\end{align*}
\end{prop}

We deduce from this proposition that the set of squares in~$ℤ_2$ is
exactly~$4^{ℤ} (1 + 8 ℤ_2)$, and that $ℚ_2^{×}$~modulo the squares has
the eight classes~$±1, ±2, ±3, ±6$.

Write~$ℤ_4 = ℤ_2[ω]/(ω^2-ω+1)$. We then have~$(1-2ω)^2 = -3$, which is
therefore a square in~$ℤ_4$ (but not in~$ℤ_2$).

\begin{prop}
There exists group isomorphisms
\begin{align*}
ℤ_4^{×} &≃ ω^{ℤ/6ℤ} × (1 - 2 ω)^{ℤ_2} × (1 + 4 ω)^{ℤ_2};\\
(ℤ_4/2^m ℤ_4)^{×} &≃ \begin{cases} ω^{ℤ/3ℤ},& m = 1;\\
ω^{ℤ/6ℤ} × (1-2ω)^{ℤ/2^{m-1}ℤ} × (1+4ω)^{ℤ/2^{m-2}ℤ}, & m ≥ 2.\\ \end{cases}
\end{align*}
\end{prop}
In this decomposition, the subgroup~$ℤ_2^{×}$ manifests itself
as~$ω^{3ℤ/6ℤ} × (1-2ω)^{2 ℤ_2}$.


\begin{prop}
Let~$A_n = ℤ_2[2^n ω]$ be the order of~$ℚ_4$ with conductor~$2^n ℤ_4$.
Then
\begin{align*}
A_1^{×} &≃ (-1)^{ℤ/2ℤ} × (1-2ω)^{ℤ_2} × (1 + 4 ω)^{ℤ_2};\\
A_n^{×} &≃ (-1)^{ℤ/2ℤ} × (-3)^{ℤ_2} × (1+2^nω)^{ℤ_2},\quad n ≥ 2.
\end{align*}
\end{prop}


The ramified extension~$ℚ_2[√{-1}]$ has the uniformiser~$π = √{-1}-1$ and
the integer ring~$ℤ_2[π]$. 
\begin{prop}
There exists group isomorphisms
\begin{align*}
ℤ_2[√{-1}]^{×} &≃ (√{-1})^{ℤ/4ℤ} × (-3)^{ℤ_2} × (1+2π)^{ℤ_2};\\
(ℤ_2[√{-1}]/π^m ℤ_2[√{-1}])^{×} &≃\begin{cases}
(1+π)^{ℤ/2^{m-1}ℤ},&m ≤ 2;\\
(1+π)^{ℤ/4ℤ} ×(-3)^{ℤ/2^{r-1} ℤ} ×(1+2π)^{ℤ/2^{r-1}ℤ},&m=2r+1,r ≥ 1;\\
(1+π)^{ℤ/4ℤ} ×(-3)^{ℤ/2^{r-1} ℤ} ×(1+2π)^{ℤ/2^{r}ℤ},&m=2r+2,r ≥ 1.\\
\end{cases}\end{align*}
% In this decomposition, the subgroup~$ℤ_2^{×}$ manifests itself
% as $(√{-1})^{2ℤ/4ℤ} × (-3)^{ℤ_2}$.
\end{prop}

The ramified extension~$ℚ_2[√{3}]$ has the uniformiser~$π = √{3}-1$ and
the integer ring~$ℤ_2[π]$.
\begin{prop}
There exists group isomorphisms
\begin{align*}
ℤ_2[√{3}]^{×} &≃ (-1)^{ℤ/2ℤ} × (1+π)^{ℤ_2} × (1+2π)^{ℤ_2};\\
(ℤ_2[√{3}]/π^m ℤ_2[√{3}])^{×} &≃\begin{cases}
(1+π)^{ℤ/2ℤ},&m = 2;\\
(1+π)^{ℤ/4ℤ},&m = 3;\\
(1+π)^{ℤ/4ℤ} × (1+2π)^{ℤ/2ℤ},&m = 4;\\
(-1)^{ℤ/2ℤ} × (1+π)^{ℤ/2^rℤ} × (1+2π)^{ℤ/2^{r-1} ℤ},&m = 2r+1, r ≥ 2;\\
(-1)^{ℤ/2ℤ} × (1+π)^{ℤ/2^r ℤ} × (1+2π)^{ℤ/2^r ℤ},&m = 2r+2, r ≥ 2.
\end{cases}
\end{align*}
\end{prop}

Note that in $(ℤ_2[√{3}]/π^4)^{×}$ there is the relation $-1 ≡ (1+π)^2
\pmod{π^4}$; therefore, we have
\begin{equation}
v_{π} ((1+π)^{2^n} - 1) = \begin{cases}n+1,& n ≤ 1;\\2n+2,&n ≥ 2. \end{cases}
\end{equation}


The ramified extension~$ℚ[√2]$ has the uniformiser~$π = √{2}$. The group
$1+2π ℤ_2[π]$ is topologically generated by~$(-1)·(1+π)^2 = 1 + 2π + 4$.
% For each~$n$, we have~$v_{π} ((1+π)^{2^n}-1) = n+1$ if~$n ≤ 1$
% and~$2n+1$ if~$n ≥ 2$.
\begin{prop}
There exists group isomorphisms
\begin{align*}
ℤ_2[π]^{×} &≃ (-1)^{ℤ/2ℤ} × (-3)^{ℤ_2} × (1+π)^{ℤ_2},\\
(ℤ_2[π]/π^m)^{×} &≃ \begin{cases}(1+π)^{ℤ/2^{m-1}ℤ},&m ≤ 2;\\
(-1)^{ℤ/2ℤ} × (-3)^{ℤ/2^{r-2}ℤ} × (1+π)^{ℤ/2^{r}ℤ},&m=2r, r≥2;\\
(-1)^{ℤ/2ℤ} × (-3)^{ℤ/2^{r-1}ℤ} × (1+π)^{ℤ/2^{r}ℤ},&m=2r+1, r≥2.
\end{cases}\end{align*}
\end{prop}

% \begin{lem}
% Let~$D ∈ ℤ_2$ and write
% \[ ρ(D) = \max \acco { v_{2} (x^2 - D), x ∈ ℤ_2 }. \]
% Then
% \begin{enumerate}
% \item if $D ≡ 0 \pmod{4}$, then $ρ(D) = ρ(D/4) + 1$;
% \item if $D ≡ 2 \pmod{4}$, then $ρ(D) = 1$;
% \item if $D ≡ 3 \pmod{4}$, then $ρ(D) = 1$;
% \item if $D ≡ 5 \pmod{8}$, then $ρ(D) = 2$;
% \item if $D ≡ 1 \pmod{8}$, then $D$~is a square in~$ℤ_2$ (in other words,
% $ρ(D) = +∞$).
% \end{enumerate}
% \end{lem}

\subsection{Conjugacy classes of matrices}

Let~$f(x) = x^2 + px + q$ be a quadratic polynomial with coefficients
in~$ℤ_2$, and let~$\ro M(f)$ be the set of all similarity classes of
matrices over~$ℤ_2$ with characteristic polynomial~$f$. Let~$D = p^2 -
4q$ be the  discriminant of~$f$. Write~$D = 4^n u^2 d$ with~$n ≥ 0$, $u ∈
ℤ_2^{×}$, and~$d ∈ \acco { -1, ±2, ±3, ±6 }$.

The case~$d = 1$ corresponds to $f$~split.


In all other cases, let~$A = ℤ_2[α]$; the fraction field of~$A$
is~$ℚ_2(α) = ℚ_2(√{d})$, and the set~$\ro M(f)$ is in bijection with the
set~$\Cl(A)$ of classes of ideals of~$A$. Note that, since $A$~is
generally not a Dedekind ring, $\Cl(A)$~is strictly larger than the
Picard group of~$A$. Write~$\ro I(α)$ for the monoid of all non-zero
fractional ideals of~$ℤ_2[α]$.

\paragraph{If $p$~is odd.} Since $f$~is irreducible, its Newton polygon
has only one slope, and therefore $q$~is also odd. This implies that~$D ≡
5 \pmod{8}$ and thus $D = -3 u^2$ with~$u ∈ ℤ_2^{×}$; therefore, $ℤ_2[α] =
ℤ_4$ and $\Cl(ℤ_2[α]) = 1$.

\medskip

In all other cases, note that since $p$~is even, $D = p^2-4q$~is
divisible by~$4$, so that $D = 4^n u^2 d$ with~$n ≥ 1$. We may assume
that~$u = 1$.

\paragraph{If $d = -3$.} In this case, $ℚ_2(√d) = ℚ_4$. Its
maximal order is generated by~$ω = \frac{1+√{-3}}{2}$, and we may
write~$2^n u ω = α + p/2 + 2^{n-1}u$. Therefore, $ℤ_2[α]$~is the
order~$A_n = ℤ_2[2^n ω]$ of~$ℚ_4$ with conductor~$2^n$.


\begin{prop}
The classes of fractional ideals of~$A_n$ are represented by the
classes~$A_i$ for~$0 ≤ i ≤ n$.
\end{prop}

\begin{proof}
A fractional ideal of~$A_n$ is a $ℤ_2$-lattice~$\fr a ⊂ ℚ_4$ that is
stable by multiplication by~$2^n ω$. Moreover, equivalence of fractional
ideals corresponds to equivalence of lattices by multiplication by an
element of~$ℚ_4^{×}$.

Each lattice is then equivalent to a lattice with
basis~$(1, τ)$ with~$τ ∈ ℤ_4 ∖ ℤ_2$. By replacing~$τ$ with~$a τ + b$
with~$a ∈ ℤ_2^{×}$ and~$b ∈ ℤ_2$, we may assume that~$τ = 2^i ω$ for
some~$i ≥ 0$, \emph{i.e.} that $(1, τ) = A_i$. The lattice $A_i$~is a
$A_n$-fractional ideal when~$n ≥ i$; conversely, this proves that the
fractional ideals of~$A_n$ are equivalent to the~$A_i$ with~$i ≤ n$.
\end{proof}

\begin{prop}
\begin{enumerate}
The quotient~$\ro I(α) / ℚ_2^{×}$ is represented by the set of all
ideals $(2^e, b + 2^n ω)$ with~$0 ≤ e ≤ 2n$ and~$b ∈ ℤ/2^eℤ$ such
that~$b^2 = 0$.
\end{enumerate}
\end{prop}

\begin{proof}
Any $ℤ_2$-module~$\fr a$ of rank two in~$ℚ_4$ is generated
by elements~$(2^e, b + 2^{f} ω)$ for some integers~$e, f ∈ ℤ$ and
some~$b ∈ ℚ_2$. Up to multiplication by a power of two, we may assume
that~$f = n$. Then $\fr a$~is a $A_n$-fractional ideal if, and only if, it is
stable by multiplication by~$2^n ω$, which means that~$e ≥ 0$,
$b ∈ ℤ_2$, and~$2^e ∣ N_{ℚ_4/ℚ_2} (b + 2^n ω) = b^2 + 2^n b + 2^{2n}$.
The latter condition is equivalent to~$e ≤ 2 v_2(b)$ and~$e ≤ 2n$.
\end{proof}

Example for~$n = 1$: the classes of ideals modulo~$ℚ_2^{×}$ are the
ideals~$(1,0)$, $(2,0)$, $(4,0)$ and~$(4,2)$. The group~$ℚ_4^{×}/A_1^{×}$
is isomorphic to~$ω^{ℤ/3ℤ}$, and the orbit of~$(1,0)$ contains~$(4,0)$
and~$(4,2)$. Therefore, $A_1$~has two classes of ideals, namely~$(1,2ω)$
and~$(2, 2 ω)$.

Example for~$n = 2$: the classes modulo~$ℚ_2^{×}$ are the ideals~$(1,0)$,
$(2,0)$, $(4,0)$, $(4,2)$, $(8,0)$, $(8,4)$, $(16,0)$, $(16,4)$,
$(16,8)$, $(16,12)$. The group~$ℚ_4^{×} / A_2^{×}$ is isomorphic
to~$ω^{ℤ/3ℤ} × (1-2ω)^{ℤ/2ℤ}$. The action of~$ω$ has four orbits~$(1,0)$,
$(2,0)$, $(4,0)$ and~$(4,2)$, and the action of~$(1-2ω)$ permutes the
orbits of~$(1,0)$ and~$(4,2)$. Therefore, the set of classes of ideals
of~$A_2$ has three elements, represented by the ideals~$(1, 4 ω)$, $(2, 4
ω)$ and~$(4, 4ω)$.

% is~$\fr c = 2^{n} ℤ_4 = (2^n, α+p/2+2^{n-1} u)$, 
% \begin{equation}
% ℤ_2[α]/\fr c ≃ ℤ/2^n ℤ, \quad
% (ℤ_2[α]/\fr c)^{×} ≃ \begin{cases} 1, & n = 1;\\
% (-1)^{ℤ/2ℤ} × (-3)^{ℤ/2^{n-2}ℤ},& n ≥ 2.\\\end{cases}
% \end{equation}
% From this we deduce
% \begin{equation}
% H(ℤ_2[α]) ≃ 
% \begin{cases} ℤ/3ℤ,& n = 1;\\ (ℤ/6ℤ) × (ℤ/2^{n-2}ℤ), & n ≥ 2. \end{cases}
% \end{equation}
% 
\paragraph{If $d = -1$.} In this case, $π = √{-1}-1$ is a uniformiser
of~$ℚ(√{d})$, and we may write~$2^{n-1} u π = α + p/2 - 2^{n-1} u$.
Therefore, the conductor of~$ℤ_2[α]$ is~$\fr c = 2^{n-1}
ℤ_2[π] = (2^{n-1}, α+p/2-2^{n-1} u)$, and we have
\begin{equation}
ℤ_2[α]/\fr c ≃ ℤ/2^{n-1} ℤ, \quad
(ℤ_2[α]/\fr c)^{×} ≃ \begin{cases} 1,&n ≤ 2;\\
(-1)^{ℤ/2ℤ} × (-3)^{ℤ/2^{n-3} ℤ},&n ≥ 3.\end{cases}
\end{equation}
From this we deduce
\begin{equation}
H(ℤ_2[α]) ≃ \begin{cases} 0, & n = 1;\\
ℤ/2ℤ, & n = 2;\\ (ℤ/4ℤ) × (ℤ/2^{n-2}ℤ), & n ≥ 3. \end{cases}
\end{equation}

\paragraph{If $d = 3$.} In this case, $π = √{3}-1$ is a uniformiser
of~$ℚ(√{d})$, and we may write~$2^{n-1} u π = α + p/2 - 2^{n-1} u$. As in
the previous case, we have
\begin{equation}
ℤ_2[α]/\fr c ≃ ℤ/2^{n-1} ℤ, \quad
(ℤ_2[α]/\fr c)^{×} ≃ \begin{cases} 1,&n ≤ 2;\\
(-1)^{ℤ/2ℤ} × (-3)^{ℤ/2^{n-3} ℤ},&n ≥ 3.\end{cases}
\end{equation}
From this we deduce
\begin{equation}
H(ℤ_2[α]) ≃ \begin{cases} 0, & n = 1;\\
(ℤ/2ℤ) × (ℤ/2^{n-2}ℤ),& n ≥ 2.\\\end{cases}
% n = 3: générateurs = 3 et 1+2π
% n ≥ 4: générateurs = -3 et 1+2π
\end{equation}
\end{document}
